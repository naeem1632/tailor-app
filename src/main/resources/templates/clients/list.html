<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Clients</title>
    <meta charset="UTF-8">
    <style>
        body {
          font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
          background: #f0f2f5;
          margin: 0;
          padding: 0;
        }

        /* Header Section */
        .header-table {
          width: 100%;
          background: #fff;
          padding: 0;
          box-shadow: 0 2px 6px rgba(0,0,0,0.1);
          text-align: center;
        }

        .header-table img {
          width: 25%;
          height: 120px;
          object-fit: contain;
        }

        h1 {
          text-align: center;
          color: #17a2b8; /* sky blue */
          margin: 25px 0 15px;
          font-size: 26px;
        }

        /* Flash Messages */
        .alert {
          max-width: 800px;
          margin: 15px auto;
          padding: 12px 15px;
          border-radius: 6px;
          font-size: 14px;
          font-weight: 500;
        }
        .alert-success {
          background: #d4edda;
          color: #155724;
          border: 1px solid #c3e6cb;
        }
        .alert-danger {
          background: #f8d7da;
          color: #721c24;
          border: 1px solid #f5c6cb;
        }

        /* Search Form */
        form.search-form {
          text-align: center;
          margin: 15px auto;
        }
        form.search-form input[type="text"] {
          padding: 10px;
          width: 300px;
          border: 1px solid #ccc;
          border-radius: 6px;
          font-size: 14px;
        }
        form.search-form button {
          padding: 10px 18px;
          margin-left: 6px;
          background: #17a2b8; /* sky blue */
          border: none;
          border-radius: 6px;
          color: white;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }
        form.search-form button:hover {
          background: #138496; /* darker teal */
        }

        /* Add Button */
        a.add-btn {
          display: inline-block;
          margin: 10px auto 20px auto;
          background: #28a745;
          color: white;
          padding: 10px 18px;
          border-radius: 6px;
          text-decoration: none;
          font-weight: 600;
          transition: background 0.2s, transform 0.1s;
        }
        a.add-btn:hover {
          background: #218838;
          transform: scale(1.03);
        }
        .add-btn-container {
          text-align: center;
        }

        /* Table */
        table {
          width: 95%;
          margin: 0 auto 40px auto;
          border-collapse: collapse;
          background: white;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        thead {
          background: #17a2b8; /* sky blue */
          color: white;
        }
        th, td {
          padding: 12px 10px;
          text-align: center;
          font-size: 14px;
          border-bottom: 1px solid #eaeaea;
        }
        tbody tr:hover {
          background: #f8f9fa;
        }
        td img {
          border: 1px solid #ccc;
          border-radius: 6px;
          max-height: 60px;
        }

        /* Action Links */
        td a {
          text-decoration: none;
          font-weight: 500;
          color: #17a2b8; /* sky blue */
          margin: 0 6px;
          transition: color 0.2s;
        }
        td a:hover {
          color: #0f6674; /* darker teal */
          text-decoration: underline;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
          const flashMsg = document.getElementById("flashMessage");
          if (flashMsg) {
            setTimeout(() => {
              flashMsg.style.transition = "opacity 0.8s";
              flashMsg.style.opacity = "0";
              setTimeout(() => flashMsg.remove(), 800);
            }, 3000);
          }
          const flashErr = document.getElementById("flashError");
          if (flashErr) {
            setTimeout(() => {
              flashErr.style.transition = "opacity 0.8s";
              flashErr.style.opacity = "0";
              setTimeout(() => flashErr.remove(), 800);
            }, 4000);
          }
        });
    </script>
</head>
<body>

<!-- Flash Messages -->
<div th:if="${message}" id="flashMessage" class="alert alert-success">
    <span th:text="${message}"></span>
</div>
<div th:if="${error}" id="flashError" class="alert alert-danger">
    <span th:text="${error}"></span>
</div>

<!-- Header -->
<div class="header-table">
    <img th:src="@{/images/header.png}" alt="Logo Banner"/>
</div>

<h1>All Clients</h1>

<!-- Search -->
<form class="search-form" method="get" action="/clients">
    <input type="text" name="q" placeholder="Search by name or mobile" th:value="${param.q}">
    <button type="submit">Search</button>
</form>

<!-- Add New Client Button -->
<div class="add-btn-container">
    <a href="/clients/new" class="add-btn">+ Add New Client</a>
</div>

<!-- Clients Table -->
<table>
    <thead>
    <tr>
        <th>S#</th>
        <th>Name</th>
        <th>Mobile#</th>
        <th>Whatsapp#</th>
        <th>Address</th>
        <th>Picture</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="client, stat : ${clients}">
        <td th:text="${client.id}"></td>
        <td th:text="${client.name}"></td>
        <td th:text="${client.mobile}"></td>
        <td th:text="${client.whatsAppNo}"></td>
        <td th:text="${client.address}"></td>
        <td>
            <img th:if="${client.pictureFilename}" th:src="@{${client.pictureFilename}}" width="80"/>
        </td>
        <td>
            <a th:href="@{'/clients/view/' + ${client.id}}">Measurements</a> |
            <a th:href="@{'/clients/edit/' + ${client.id}}">Edit</a> |
            <a th:href="@{'/payments/client/' + ${client.id}}">Schedule & Payments</a>
        </td>
    </tr>
    </tbody>
</table>

</body>
</html>
