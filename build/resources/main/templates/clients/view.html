<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Client Details</title>
  <meta charset="UTF-8"/>

  <style>
    /* ========== Base Styles ========== */
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 20px;
    }

    h1, h2, h3 {
      text-align: center;
      color: #17a2b8;
      margin: 20px 0;
      font-size: 24px;
    }

    /* ========== Flash Messages ========== */
    .alert {
      max-width: 800px;
      margin: 15px auto;
      padding: 12px 15px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert-danger {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    /* ========== Client Info ========== */
    .client-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .client-details p {
      margin: 5px 0;
      font-size: 15px;
      color: #495057;
    }

    .client-photo {
      text-align: center;
      margin: 15px 0;
    }

    .client-photo img {
      max-width: 150px;
      border-radius: 6px;
      border: 1px solid #ddd;
    }

    /* ========== Table Layout ========== */
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      margin-bottom: 25px;
    }

    thead {
      background: #17a2b8;
      color: #fff;
    }

    thead tr.section-title th {
      position: relative;
      font-size: 18px;
      padding: 12px 20px;
      text-align: left;
    }

    thead tr.section-title img {
      position: absolute;
      right: 20px;
      top: 4px;
      height: 40px;
    }

    thead tr.sub-header {
      background: #e9f8fb;
      color: #17a2b8;
      font-weight: 600;
    }

    thead tr.sub-header th {
      padding: 8px 20px;
    }

    tbody tr {
      border-bottom: 2px solid #dcdcdc;
      transition: background 0.2s;
    }

    tbody tr:last-child {
      border-bottom: none;
    }

    tbody tr:hover {
      background: #f7f9fa;
    }

    table th, table td {
      padding: 10px 12px;
      vertical-align: middle;
    }

    table th:first-child, table td:first-child {
      width: 160px;
      text-align: left;
    }

    table th:nth-child(2), table td:nth-child(2) {
      text-align: left;
    }

    table th:last-child, table td:last-child {
      width: 220px;
      text-align: right;
    }

    /* ========== Accordion Buttons ========== */
    .accordion-tabs {
      display: inline-flex;
      gap: 6px;
    }

    .accordion-btn {
      flex: 1;
      padding: 6px 10px;
      background: #e9f8fb;
      color: #17a2b8;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s;
    }

    .accordion-btn:hover,
    .accordion-btn.active {
      background: #17a2b8;
      color: #fff;
    }

    /* ========== Full-width Accordion ========== */
    .accordion-row {
      display: none;
      background: #fff;
    }

    .accordion-row.show {
      display: table-row;
    }

    .accordion-cell {
      padding: 0;
      background: #fff;
    }

    .accordion-content-group {
      padding: 15px 20px;
      transition: all 0.3s ease-in-out;
      background: #f9fcff;
      border-top: 2px solid #17a2b8;
    }

    .accordion-content {
      display: none;
      padding-top: 10px;
    }

    .accordion-content.show {
      display: block;
    }

    .accordion-content table {
      width: 25%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 6px;
      overflow: hidden;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
    }

    .accordion-content th {
      text-align: left;
      width: 220px;
      background: #f1f9ff;
      padding: 8px;
      font-weight: 600;
      font-size: 13px;
      color: #0d6efd;
      border-right: 1px solid #e0e0e0;
    }

    .accordion-content td {
      text-align: left;
      padding: 8px;
      font-size: 13px;
      color: #333;
      border-bottom: 1px solid #f1f1f1;
    }

    .accordion-content tr:nth-child(even) td {
      background: #f9fbfc;
    }

    /* ========== Form Styling ========== */
    form.measure-form {
      background: #fff;
      padding: 20px;
      margin-top: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
      display: none;
    }

    .grid-8 {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 12px;
    }

    label {
      display: block;
      font-weight: 600;
      margin-bottom: 4px;
      font-size: 13px;
      color: #17a2b8;
    }

    input, select, textarea {
      width: 100%;
      padding: 6px 8px;
      font-size: 13px;
      border: 1px solid #ccc;
      border-radius: 4px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    input:focus, select:focus, textarea:focus {
      border-color: #17a2b8;
      box-shadow: 0 0 3px rgba(23, 162, 184, 0.5);
      outline: none;
    }

    textarea {
      grid-column: span 8;
      height: 60px;
    }

    .section-title {
      grid-column: span 8;
      background: #17a2b8;
      color: #fff;
      padding: 8px 10px;
      font-weight: bold;
      border-radius: 4px;
      margin-top: 10px;
      font-size: 14px;
      letter-spacing: 0.5px;
    }

    /* ========== Buttons & Links ========== */
    .actions {
      margin: 20px 0;
      text-align: center;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      background: #28a745;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: background 0.2s, transform 0.1s;
    }

    button:hover {
      background: #218838;
      transform: scale(1.03);
    }

    a.home-link {
      display: inline-block;
      margin-top: 20px;
      padding: 10px 20px;
      background: #17a2b8;
      color: #fff;
      border-radius: 6px;
      font-weight: 600;
      text-decoration: none;
      transition: background 0.2s, transform 0.1s;
    }

    a.home-link:hover {
      background: #138496;
      transform: scale(1.03);
    }

    /* ========== Option Images ========== */
    .options-inline img {
      width: 40px;
      height: auto;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 2px;
      transition: transform 0.2s ease-in-out;
      cursor: pointer;
    }

    .options-inline img:hover {
      transform: scale(2);
      z-index: 10;
      position: relative;
    }

    /* ===================== Accordion Animation & Polish ===================== */

      /* smooth expand/collapse animation */
      .accordion-content-group {
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transform: translateY(-5px);
        transition:
          max-height 0.4s ease,
          opacity 0.3s ease,
          transform 0.3s ease;
      }

      /* when open */
      .accordion-row.show .accordion-content-group {
        max-height: 1000px; /* enough space for all content */
        opacity: 1;
        transform: translateY(0);
      }

      /* subtle highlight on active section */
      .accordion-btn.active {
        background: #17a2b8 !important;
        color: #fff !important;
        box-shadow: 0 0 6px rgba(23, 162, 184, 0.4);
        transform: scale(1.02);
      }

      /* smoother row border transition */
      tbody tr {
        transition: background 0.25s, border-color 0.25s;
      }

      tbody tr:hover {
        background: #f7fbfc;
        border-color: #bce0e8;
      }

      /* section icons larger & visually balanced */
      .section-title img {
        height: 44px;
        width: auto;
        filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2));
      }

      /* table headers slightly bold and clean */
      thead .sub-header th {
        letter-spacing: 0.3px;
        font-size: 15px;
      }

      /* make accordion table cells feel airy */
      .accordion-content th,
      .accordion-content td {
        padding: 10px 12px;
      }

  </style>

  <script>
    function toggleForm(formId) {
      document.querySelectorAll("form.measure-form").forEach(f => f.style.display = "none");
      const form = document.getElementById(formId);
      if (form) {
        form.style.display = "block";
        window.scrollTo({ top: form.offsetTop - 10, behavior: 'smooth' });
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      /* ================= ACCORDION TOGGLE (for both Dress + Waistcoat) ================= */
      document.querySelectorAll("tbody tr").forEach(row => {
        const nextRow = row.nextElementSibling;
        if (!nextRow || !nextRow.classList.contains("accordion-row")) return;

        const buttons = row.querySelectorAll(".accordion-btn");
        const contents = nextRow.querySelectorAll(".accordion-content");

        buttons.forEach(btn => {
          btn.addEventListener("click", () => {
            const target = btn.getAttribute("data-target");
            const targetContent = nextRow.querySelector(`.${target}`);
            const isVisible = targetContent.classList.contains("show");

            // reset within this row group
            buttons.forEach(b => b.classList.remove("active"));
            contents.forEach(c => c.classList.remove("show"));
            nextRow.classList.remove("show");

            if (!isVisible) {
              btn.classList.add("active");
              targetContent.classList.add("show");
              nextRow.classList.add("show");
            }
          });
        });
      });

      /* ================= AUTO-HIDE FLASH MESSAGES ================= */
      const flashMsg = document.getElementById("flashMessage");
      if (flashMsg) {
        setTimeout(() => {
          flashMsg.style.transition = "opacity 0.8s";
          flashMsg.style.opacity = "0";
          setTimeout(() => flashMsg.remove(), 800);
        }, 3000);
      }

      const flashErr = document.getElementById("flashError");
      if (flashErr) {
        setTimeout(() => {
          flashErr.style.transition = "opacity 0.8s";
          flashErr.style.opacity = "0";
          setTimeout(() => flashErr.remove(), 800);
        }, 4000);
      }

      /* ================= KEEP FORM OPEN WHEN EDITING ================= */
      const dressForm = document.getElementById("measurementForm");
      const waistForm = document.getElementById("waistcoatForm");
      if (dressForm && dressForm.getAttribute("data-open") === "true") {
        dressForm.style.display = "block";
      }
      if (waistForm && waistForm.getAttribute("data-open") === "true") {
        waistForm.style.display = "block";
      }
    });
  </script>


</head>
<body>

<!-- Flash Messages -->
<div th:if="${message}" id="flashMessage" class="alert alert-success">
  <span th:text="${message}"></span>
</div>
<div th:if="${error}" id="flashError" class="alert alert-danger">
  <span th:text="${error}"></span>
</div>

<div class="header-table">
  <h1 th:text="'Measurements for ' + ${client.name}"></h1>
</div>

<div class="client-photo">
  <img th:if="${client.pictureFilename}" th:src="@{${client.pictureFilename}}" alt="Client Picture"/>
</div>

<!-- Action Buttons -->
<div class="actions">
  <button type="button" th:if="${#lists.isEmpty(dressMeasurements)}" onclick="toggleForm('measurementForm')">+ Add Dress Measurement</button>
  <button type="button" th:if="${#lists.isEmpty(waistcoatMeasurements)}" onclick="toggleForm('waistcoatForm')">+ Add Waistcoat Measurement</button>
</div>

<!-- ===================== DRESS LIST (Accordion + Edit/Delete) ===================== -->

<table>
  <!-- ===== TABLE HEADER ===== -->
  <thead>
  <tr class="section-title">
    <th colspan="3">
      Dress
      <img src="/images/dress_icon.png" alt="Dress Icon">
    </th>
  </tr>
  <tr class="sub-header">
    <th>Date</th>
    <th>Measurements</th>
    <th>Actions</th>
  </tr>
  </thead>

  <!-- ===== TABLE BODY ===== -->
  <tbody>
  <th:block th:each="m, iter : ${dressMeasurements}">
    <!-- MAIN ROW -->
    <tr>
      <!-- Date -->
      <td th:text="${#temporals.format(m.date, 'dd-MMM-yyyy')}" style="font-weight:600;"></td>

      <!-- Accordion Buttons -->
      <td>
        <div class="accordion-tabs">
          <button class="accordion-btn" data-target="kameez">Kameez</button>
          <button class="accordion-btn" data-target="shalwar">Shalwar</button>
          <button class="accordion-btn" data-target="design">Design</button>
        </div>
      </td>

      <!-- Actions (only latest record) -->
      <td th:if="${iter.index == 0}">
        <a th:href="@{/clients/view/{id}(id=${client.id}, edit=${m.id})}" style="color:#0d6efd; font-weight:600;">Edit</a> |
        <a th:href="@{/clients/deleteMeasurement/{mid}(mid=${m.id})}" onclick="return confirm('Are you sure?')" style="color:#dc3545; font-weight:600;">Delete</a> |
        <a th:href="@{/clients/copyMeasurement/{mid}(mid=${m.id})}" style="color:#28a745; font-weight:600;">Copy/Create</a>
      </td>

      <!-- Empty for older records -->
      <td th:if="${iter.index != 0}"></td>
    </tr>

    <!-- ACCORDION SUB-ROW -->
    <tr class="accordion-row">
      <td colspan="3" class="accordion-cell">
        <div class="accordion-content-group">

          <!-- KAMEEZ TAB -->
          <div class="accordion-content kameez">
            <table>
              <tr><th>Kameez Length</th><td th:text="${m.kameezLength}"></td></tr>
              <tr><th>Arm</th><td th:text="${m.arm}"></td></tr>
              <tr><th>Shoulder-arm</th><td th:text="${m.shoulderArm}"></td></tr>
              <tr><th>Upper Arm</th><td th:text="${m.upperArm}"></td></tr>
              <tr><th>Center Arm</th><td th:text="${m.centerArm}"></td></tr>
              <tr><th>Lower Arm</th><td th:text="${m.lowerArm}"></td></tr>
              <tr><th>Cuff Length</th><td th:text="${m.cuffLength}"></td></tr>
              <tr><th>Cuff Width</th><td th:text="${m.cuffWidth}"></td></tr>
              <tr><th>Terra</th><td th:text="${m.terra}"></td></tr>
              <tr><th>Terra Down</th><td th:text="${m.terraDown}"></td></tr>
              <tr><th>Collar Size</th><td th:text="${m.collarSize}"></td></tr>
              <tr><th>Bain Size</th><td th:text="${m.bainSize}"></td></tr>
              <tr><th>Chest</th><td th:text="${m.chest}"></td></tr>
              <tr><th>Chest Fitting</th><td th:text="${m.chestFitting}"></td></tr>
              <tr><th>Waist</th><td th:text="${m.waist}"></td></tr>
              <tr><th>Hip</th><td th:text="${m.hip}"></td></tr>
            </table>
          </div>

          <!-- SHALWAR TAB -->
          <div class="accordion-content shalwar">
            <table>
              <tr><th>Shalwar Length</th><td th:text="${m.shalwarLength}"></td></tr>
              <tr><th>Shalwar Fitting</th><td th:text="${m.shalwarFitting}"></td></tr>
              <tr><th>Asan</th><td th:text="${m.asan}"></td></tr>
              <tr><th>Payncha</th><td th:text="${m.payncha}"></td></tr>
            </table>
          </div>

          <!-- DESIGN TAB -->
          <div class="accordion-content design">
            <table>
              <tr><th>Collar Design</th><td th:text="${m.collarType}"></td></tr>
              <tr>
                <th>Bain Design</th>
                <td>
                  <img th:if="${m.bainType == 'Round-Bain'}" src="/images/bain_round.png" width="30" title="Round"/>
                  <img th:if="${m.bainType == 'Square-Bain'}" src="/images/bain_square.png" width="30" title="Square"/>
                  <img th:if="${m.bainType == 'Cut-Bain'}" src="/images/bain_cut.png" width="30" title="Cut"/>
                </td>
              </tr>
              <tr><th>Daman Type</th><td th:text="${m.damanType}"></td></tr>
              <tr><th>Daman Stitching</th><td th:text="${m.damanStitching}"></td></tr>
              <tr><th>Side Pocket</th><td th:text="${m.sidePocket}"></td></tr>
              <tr><th>Front Pocket</th><td th:text="${m.frontPocket} ? 'Yes' : 'No'"></td></tr>
              <tr>
                <th>Front Pocket Design</th>
                <td>
                  <!-- support both 'Round' and legacy 'Plain' values -->
                  <img th:if="${m.frontPocketType == 'Round' or m.frontPocketType == 'Plain'}" src="/images/pocket_round.png" width="30" title="Round/Plain"/>
                  <img th:if="${m.frontPocketType == 'Cut'}" src="/images/pocket_cut.png" width="30" title="Cut"/>
                  <img th:if="${m.frontPocketType == 'Square'}" src="/images/pocket_square.png" width="30" title="Square"/>
                </td>
              </tr>
              <tr><th>Cuff Type</th><td th:text="${m.cuffType}"></td></tr>
              <tr>
                <th>Cuff Design</th>
                <td>
                  <img th:if="${m.cuffDesign == 'Round-Cuff'}" src="/images/cuff_round.png" width="30" title="Round"/>
                  <img th:if="${m.cuffDesign == 'Square-Cuff'}" src="/images/cuff_square.png" width="30" title="Square"/>
                  <img th:if="${m.cuffDesign == 'Cut-Cuff'}" src="/images/cuff_cut.png" width="30" title="Cut"/>
                </td>
              </tr>
              <tr><th>Jali</th><td th:text="${m.jali}"></td></tr>
              <tr><th>Kanta</th><td th:text="${m.kanta} ? 'Yes' : 'No'"></td></tr>
              <tr><th>Shalwar Pocket</th><td th:text="${m.shalwarPocket} ? 'Yes' : 'No'"></td></tr>
              <tr><th>Stitch Type</th><td th:text="${m.stitchType}"></td></tr>
              <tr><th>Design Stitch</th><td th:text="${m.designStitch} ? 'Yes' : 'No'"></td></tr>
              <tr><th>Button Type</th><td th:text="${m.buttonType}"></td></tr>
              <tr><th>Front Patti Kaj</th><td th:text="${m.frontPattiKaj}"></td></tr>
              <tr><th>Front Patti Design</th><td th:text="${m.frontPattiType}"></td></tr>
              <tr><th>Notes</th><td th:text="${m.notes}"></td></tr>
            </table>
          </div>

        </div>
      </td>
    </tr>
  </th:block>
  </tbody>
</table>


<!-- ===================== DRESS FORM ===================== -->
<form id="measurementForm"
      class="measure-form"
      th:action="@{${formAction}}"
      method="post"
      th:object="${dressMeasurement}"
      th:attr="data-open=${dressMeasurement.id} != null ? 'true' : 'false'"
      th:style="${dressMeasurement.id} != null ? 'display:block;' : 'display:none;'">

  <input type="hidden" th:field="*{id}"/>

  <div class="grid-8">
    <!-- Section: Kameez -->
    <div class="section-title">Kameez Measurements</div>

    <div><label>Kameez Length:</label><input type="text" th:field="*{kameezLength}" required/></div>
    <div><label>Arm:</label><input type="text" th:field="*{arm}" required/></div>
    <div><label>Shoulder-arm:</label><input type="text" th:field="*{shoulderArm}"/></div>
    <div><label>Upper Arm:</label><input type="text" th:field="*{upperArm}"/></div>
    <div><label>Center Arm:</label><input type="text" th:field="*{centerArm}"/></div>
    <div><label>Lower Arm:</label><input type="text" th:field="*{lowerArm}"/></div>
    <div><label>Cuff Length:</label><input type="text" th:field="*{cuffLength}"/></div>
    <div><label>Cuff Width:</label><input type="text" th:field="*{cuffWidth}"/></div>
    <div><label>Terra:</label><input type="text" th:field="*{terra}" required/></div>
    <div><label>Terra Down:</label><input type="text" th:field="*{terraDown}"/></div>
    <div><label>Collar Size:</label><input type="text" th:field="*{collarSize}"/></div>
    <div><label>Bain Size:</label><input type="text" th:field="*{bainSize}"/></div>
    <div><label>Chest:</label><input type="text" th:field="*{chest}" required/></div>
    <div><label>Chest Fitting:</label><input type="text" th:field="*{chestFitting}"/></div>
    <div><label>Waist:</label><input type="text" th:field="*{waist}" required/></div>
    <div><label>Hip:</label><input type="text" th:field="*{hip}" required/></div>

    <!-- Section: Shalwar -->
    <div class="section-title">Shalwar Measurements</div>
    <div><label>Shalwar Length:</label><input type="text" th:field="*{shalwarLength}" required/></div>
    <div><label>Shalwar Fitting:</label><input type="text" th:field="*{shalwarFitting}"/></div>
    <div><label>Asan:</label><input type="text" th:field="*{asan}" required/></div>
    <div><label>Payncha:</label><input type="text" th:field="*{payncha}" required/></div>

    <!-- Section: Design & Finishing -->
    <div class="section-title">Design &amp; Finishing</div>
    <div>
      <label>Collar design:</label>
      <select th:field="*{collarType}">
        <option value="1">1</option><option value="2">2</option>
        <option value="3">3</option><option value="4">4</option>
        <option value="5">5</option><option value="6">6</option>
        <option value="7">7</option><option value="8">8</option>
        <option value="9">9</option><option value="10">10</option>
      </select>
    </div>

    <div class="options-row">
      <label>Bain Design:</label>
      <div class="options-inline">
        <label><input type="radio" th:field="*{bainType}" value="Round-Bain"/><img src="/images/bain_round.png" alt="Round"/> Round</label>
        <label><input type="radio" th:field="*{bainType}" value="Square-Bain"/><img src="/images/bain_square.png" alt="Square"/> Square</label>
        <label><input type="radio" th:field="*{bainType}" value="Cut-Bain"/><img src="/images/bain_cut.png" alt="Cut"/> Cut</label>
      </div>
    </div>

    <div>
      <label>Daman Type:</label>
      <select th:field="*{damanType}">
        <option value="Square">Square</option>
        <option value="Round">Round</option>
      </select>
    </div>

    <div>
      <label>Daman Stitching:</label>
      <select th:field="*{damanStitching}">
        <option value="Single">Single</option>
        <option value="Double">Double</option>
      </select>
    </div>

    <div>
      <label>Side Pocket:</label>
      <select th:field="*{sidePocket}">
        <option value="No">No</option>
        <option value="1">1</option>
        <option value="2">2</option>
      </select>
    </div>

    <div><label>Front Pocket:</label><input type="checkbox" th:field="*{frontPocket}"/></div>

    <div class="options-row">
      <label>Pocket Design:</label>
      <div class="options-inline">
        <!-- keeping your existing values -->
        <label><input type="radio" th:field="*{frontPocketType}" value="Round"/><img src="/images/pocket_round.png" alt="Round"/> Round</label>
        <label><input type="radio" th:field="*{frontPocketType}" value="Cut"/><img src="/images/pocket_cut.png" alt="Cut"/> Cut</label>
        <label><input type="radio" th:field="*{frontPocketType}" value="Square"/><img src="/images/pocket_square.png" alt="Square"/> Square</label>
      </div>
    </div>

    <div>
      <label>Cuff Type:</label>
      <select th:field="*{cuffType}">
        <option value="single">Single</option>
        <option value="Double">Double</option>
        <option value="Open">Open</option>
      </select>
    </div>

    <div class="options-row">
      <label>Cuff Design:</label>
      <div class="options-inline">
        <label><input type="radio" th:field="*{cuffDesign}" value="Round-Cuff"/><img src="/images/cuff_round.png" alt="Round"/> Round</label>
        <label><input type="radio" th:field="*{cuffDesign}" value="Square-Cuff"/><img src="/images/cuff_square.png" alt="Square"/> Square</label>
        <label><input type="radio" th:field="*{cuffDesign}" value="Cut-Cuff"/><img src="/images/cuff_cut.png" alt="Cut"/> Cut</label>
      </div>
    </div>

    <div>
      <label>Jali:</label>
      <select th:field="*{jali}">
        <option value="No">No</option>
        <option value="1">1</option>
        <option value="2">2</option>
      </select>
    </div>

    <div><label>Kanta:</label><input type="checkbox" th:field="*{kanta}"/></div>

    <div><label>Shalwar Pocket:</label><input type="checkbox" th:field="*{shalwarPocket}"/></div>

    <div>
      <label>Stitch Type:</label>
      <select th:field="*{stitchType}">
        <option value="Single">Single</option>
        <option value="Double">Double</option>
        <option value="Simple">Simple</option>
      </select>
    </div>
    <div><label>Design Stitch:</label><input type="checkbox" th:field="*{designStitch}"/></div>
    <div>
      <label>Button Type:</label>
      <select th:field="*{buttonType}">
        <option value="Plan">Plan</option>
        <option value="Metal">Metal</option>
        <option value="Tich">Tich</option>
      </select>
    </div>
    <div>
      <label>Front Patti Kaj:</label>
      <select th:field="*{frontPattiKaj}">
        <option value="4">4</option>
        <option value="5">5</option>
      </select>
    </div>
    <div>
      <label>Front Patti Type:</label>
      <select th:field="*{frontPattiType}">
        <option value="Round">Round</option>
        <option value="Square">Square</option>
        <option value="Nock">Nock</option>
      </select>
    </div>

    <!-- Notes -->
    <div style="grid-column: span 8;">
      <label>Notes:</label>
      <textarea th:field="*{notes}"></textarea>
    </div>
  </div>

  <div class="actions">
    <button type="submit">💾 Save Dress Measurement</button>
    <a th:href="@{/clients/view/{id}(id=${client.id})}"
       style="margin-left:10px; padding:10px 20px; background:#6c757d; color:#fff; border-radius:6px; font-weight:600; text-decoration:none;">
      ✖ Cancel
    </a>
  </div>

</form>

<!-- ===================== WAISTCOAT LIST (Accordion + Edit/Delete) ===================== -->

<!-- ===================== WAISTCOAT LIST ===================== -->
<table>
  <thead>
  <tr class="section-title">
    <th colspan="3">
      Waistcoat
      <img src="/images/waistcoat_icon.png" alt="Waistcoat Icon">
    </th>
  </tr>
  <tr class="sub-header">
    <th>Date</th>
    <th>Measurements</th>
    <th>Actions</th>
  </tr>
  </thead>

  <tbody>
  <th:block th:each="w, iter : ${waistcoatMeasurements}">
    <!-- MAIN ROW -->
    <tr>
      <td th:text="${#temporals.format(w.date, 'dd-MMM-yyyy')}" style="font-weight:600;"></td>

      <td>
        <div class="accordion-tabs">
          <button class="accordion-btn" data-target="measurements">Waistcoat</button>
        </div>
      </td>

      <td th:if="${iter.index == 0}">
        <a th:href="@{/clients/view/{id}(id=${client.id}, editWaistcoat=${w.id})}" style="color:#0d6efd; font-weight:600;">Edit</a> |
        <a th:href="@{/clients/deleteWaistcoatMeasurement/{id}(id=${w.id})}" onclick="return confirm('Are you sure?')" style="color:#dc3545; font-weight:600;">Delete</a> |
        <a th:href="@{/clients/copyWaistcoatMeasurement/{mid}(mid=${w.id})}" style="color:#28a745; font-weight:600;">Copy/Create</a>
      </td>

      <td th:if="${iter.index != 0}"></td>
    </tr>

    <!-- ACCORDION SUB-ROW -->
    <tr class="accordion-row">
      <td colspan="3" class="accordion-cell">
        <div class="accordion-content-group">

          <!-- Measurements -->
          <div class="accordion-content measurements">
            <table>
              <tr><th>Length</th><td th:text="${w.length}"></td></tr>
              <tr><th>Shoulder</th><td th:text="${w.shoulder}"></td></tr>
              <tr><th>Neck</th><td th:text="${w.neck}"></td></tr>
              <tr><th>Chest</th><td th:text="${w.chest}"></td></tr>
              <tr><th>Chest Fitting</th><td th:text="${w.chestFitting}"></td></tr>
              <tr><th>Hip</th><td th:text="${w.hip}"></td></tr>
              <tr><th>Bain Width</th><td th:text="${w.bainSize}"></td></tr>
              <tr><th>Bain Style</th><td th:text="${w.bainType}"></td></tr>
              <tr><th>Daman Style</th><td th:text="${w.damanType}"></td></tr>
              <tr><th>Notes</th><td th:text="${w.notes}"></td></tr>
            </table>
          </div>

        </div>
      </td>
    </tr>
  </th:block>
  </tbody>
</table>

<!-- ===================== WAISTCOAT FORM ===================== -->
<form id="waistcoatForm"
      class="measure-form"
      th:action="@{${waistcoatFormAction}}"
      method="post"
      th:object="${waistcoatMeasurement}"
      th:attr="data-open=${waistcoatMeasurement.id} != null ? 'true' : 'false'"
      th:style="${waistcoatMeasurement.id} != null ? 'display:block;' : 'display:none;'">

  <input type="hidden" th:field="*{id}"/>
  <input type="hidden" th:field="*{client.id}"/>

  <div class="grid-8">
    <div class="section-title">Waistcoat Measurements</div>

    <div><label>Length:</label><input type="text" th:field="*{length}"/></div>
    <div><label>Shoulder:</label><input type="text" th:field="*{shoulder}"/></div>
    <div><label>Neck:</label><input type="text" th:field="*{neck}"/></div>
    <div><label>Chest:</label><input type="text" th:field="*{chest}"/></div>
    <div><label>Chest Fitting:</label><input type="text" th:field="*{chestFitting}"/></div>
    <div><label>Hip:</label><input type="text" th:field="*{hip}"/></div>
    <div><label>Bain Width:</label><input type="text" th:field="*{bainSize}"/></div>

    <div>
      <label>Bain Style:</label>
      <select th:field="*{bainType}">
        <option value="Round">Round</option>
        <option value="V shape">V shape</option>
      </select>
    </div>

    <div>
      <label>Daman Style:</label>
      <select th:field="*{damanType}">
        <option value="Round">Round</option>
        <option value="Square">Square</option>
      </select>
    </div>

    <div style="grid-column: span 8;">
      <label>Notes:</label>
      <textarea th:field="*{notes}"></textarea>
    </div>
  </div>

  <div class="actions">
    <button type="submit">💾 Save Waistcoat Measurement</button>
    <a th:href="@{/clients/view/{id}(id=${client.id})}"
       style="margin-left:10px; padding:10px 20px; background:#6c757d; color:#fff; border-radius:6px; font-weight:600; text-decoration:none;">
      ✖ Cancel
    </a>
  </div>
</form>


<a th:href="@{/clients}" class="home-link">⬅ Back to Home</a>

</body>
</html>
